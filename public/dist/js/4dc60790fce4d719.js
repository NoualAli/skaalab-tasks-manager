"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[363],{7363:(e,t,a)=>{a.r(t),a.d(t,{default:()=>d});var s=a(821),i={key:0},l=["onClick"],n=[(0,s.createElementVNode)("i",{class:"las la-check-circle icon"},null,-1)];var o=a(7565);const r={layout:"MainLayout",middleware:["auth"],metaInfo:function(){return{title:"Tâches"}},created:function(){this.$store.dispatch("settings/updatePageLoading",!0)},data:function(){var e=this;return{refresh:0,columns:[{label:"#",field:"id",sortable:!0},{label:"Titre",field:"title",sortable:!0},{label:"Deadline",field:"deadline",sortable:!0},{label:"Prioritée",field:"priority",sortable:!0}],details:[{label:"#",field:"id",cols:{lg:3}},{label:"Deadline",field:"deadline",cols:{lg:3}},{label:"Date fin",field:"finished_at_formatted",cols:{lg:3}},{label:"Prioritée",field:"priority_str",cols:{lg:3}},{label:"Titre",field:"title",cols:{lg:12}},{label:"Contenu",field:"content",isHtml:!0,cols:{lg:12}},{label:"Créateur",field:"creator_name",cols:{lg:4}},{label:"Assignée à",field:"executer_name",cols:{lg:4}},{label:"Validée par",field:"validator_name",cols:{lg:4}}],actions:{edit:{show:function(t){var a=(0,o.EA)().id;return e.can("edit_task")&&!t.is_resolved&&(a==(null==t?void 0:t.created_by_id)||null==t.assigned_to_id||t.assigned_to_id==a)},apply:this.edit},delete:{show:function(t){var a=(0,o.EA)().id;return e.can("delete_task")&&!t.is_resolved&&(a==(null==t?void 0:t.created_by_id)||null==t.assigned_to_id||t.assigned_to_id==a)},apply:this.destroy}}}},methods:{edit:function(e){this.$router.push({name:"tasks-edit",params:{task:e.item.id}})},validate:function(e){var t=this;this.$swal.confirm_update("Voulez-vous marquer cette tâche comme résolue").then((function(a){a.isConfirmed&&api.put("tasks/"+e.id+"/validate").then((function(e){e.data.status?(t.refresh+=1,t.$swal.toast_success(e.data.message)):t.$swal.toast_error(e.data.message)}))})).catch((function(e){t.$swal.alert_error()}))},destroy:function(e){var t=this;this.$swal.confirm_destroy().then((function(a){a.isConfirmed&&api.delete("tasks/"+e.item.id).then((function(e){e.data.status?(t.refresh+=1,t.$swal.toast_success(e.data.message)):t.$swal.toast_error(e.data.message)}))})).catch((function(e){t.$swal.alert_error()}))}}};const d=(0,a(3744).Z)(r,[["render",function(e,t,a,o,r,d){var c=this,u=(0,s.resolveComponent)("router-link"),f=(0,s.resolveComponent)("ContentHeader"),h=(0,s.resolveComponent)("NLDatatable"),m=(0,s.resolveComponent)("ContentBody");return e.can("view_tasks")?((0,s.openBlock)(),(0,s.createElementBlock)("div",i,[(0,s.createVNode)(f,null,{actions:(0,s.withCtx)((function(){return[e.can("create_task")?((0,s.openBlock)(),(0,s.createBlock)(u,{key:0,to:{name:"tasks-create"},class:"btn btn-info"},{default:(0,s.withCtx)((function(){return[(0,s.createTextVNode)(" Ajouter ")]})),_:1})):(0,s.createCommentVNode)("",!0)]})),_:1}),(0,s.createVNode)(m,null,{default:(0,s.withCtx)((function(){return[(0,s.createVNode)(h,{columns:r.columns,details:r.details,actions:r.actions,title:"Liste des tâches",urlPrefix:"tasks",onEdit:d.edit,onDelete:d.destroy,refresh:r.refresh,onDataLoaded:t[0]||(t[0]=function(){return c.$store.dispatch("settings/updatePageLoading",!1)})},{"actions-before":(0,s.withCtx)((function(e){var t=e.item;return[t.is_resolved?(0,s.createCommentVNode)("",!0):((0,s.openBlock)(),(0,s.createElementBlock)("button",{key:0,class:"btn btn-success",onClick:(0,s.withModifiers)((function(e){return d.validate(t)}),["stop"])},n,8,l))]})),_:1},8,["columns","details","actions","onEdit","onDelete","refresh"])]})),_:1})])):(0,s.createCommentVNode)("",!0)}]])}}]);
//# sourceMappingURL=4dc60790fce4d719.js.map