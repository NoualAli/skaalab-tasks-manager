{"version":3,"file":"dist/js/4dc60790fce4d719.js","mappings":"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","sources":["webpack:///./resources/js/pages/tasks/index.vue","webpack:///./resources/js/pages/tasks/index.vue?abe8"],"sourcesContent":["<template>\n    <div v-if=\"can('view_tasks')\">\n        <ContentHeader>\n            <template #actions>\n                <router-link v-if=\"can('create_task')\" :to=\"{ name: 'tasks-create' }\" class=\"btn btn-info\">\n                    Ajouter\n                </router-link>\n                <!-- <a href=\"/excel-export?export=tasks\" target=\"_blank\" class=\"btn btn-office-excel has-icon\">\n                    <i class=\"las la-file-excel icon\" />\n                    Exporter\n                </a> -->\n            </template>\n        </ContentHeader>\n        <ContentBody>\n            <NLDatatable :columns=\"columns\" :details=\"details\" :actions=\"actions\" title=\"Liste des tâches\" urlPrefix=\"tasks\"\n                @edit=\"edit\" @delete=\"destroy\" :refresh=\"refresh\"\n                @dataLoaded=\"() => this.$store.dispatch('settings/updatePageLoading', false)\">\n                <template #actions-before=\"{ item }\">\n                    <button class=\"btn btn-success\" v-if=\"!item.is_resolved\" @click.stop=\"validate(item)\">\n                        <i class=\"las la-check-circle icon\" />\n                    </button>\n                </template>\n            </NLDatatable>\n        </ContentBody>\n    </div>\n</template>\n\n<script>\nimport { user } from '../../plugins/user';\n\nexport default {\n    layout: 'MainLayout',\n    middleware: [ 'auth' ],\n    metaInfo() {\n        return { title: 'Tâches' }\n    },\n    created() {\n        this.$store.dispatch('settings/updatePageLoading', true)\n    },\n    data() {\n        return {\n            refresh: 0,\n            columns: [\n                {\n                    label: '#',\n                    field: 'id',\n                    sortable: true\n                },\n                {\n                    label: 'Titre',\n                    field: 'title',\n                    sortable: true\n                },\n                // {\n                //     label: 'Assigné à',\n                //     field: 'executer.full_name',\n                //     sortable: true\n                // },\n                {\n                    label: 'Deadline',\n                    field: 'deadline',\n                    sortable: true\n                },\n                {\n                    label: 'Prioritée',\n                    field: 'priority',\n                    sortable: true\n                },\n            ],\n            details: [\n                {\n                    label: '#',\n                    field: 'id',\n                    cols: {\n                        lg: 3\n                    }\n                },\n                {\n                    label: 'Deadline',\n                    field: 'deadline',\n                    cols: {\n                        lg: 3\n                    }\n                },\n                {\n                    label: 'Date fin',\n                    field: 'finished_at_formatted',\n                    cols: {\n                        lg: 3\n                    }\n                },\n                {\n                    label: 'Prioritée',\n                    field: 'priority_str',\n                    cols: {\n                        lg: 3\n                    }\n                },\n                {\n                    label: 'Titre',\n                    field: 'title',\n                    cols: {\n                        lg: 12\n                    }\n                },\n                {\n                    label: 'Contenu',\n                    field: 'content',\n                    isHtml: true,\n                    cols: {\n                        lg: 12\n                    }\n                },\n                {\n                    label: 'Créateur',\n                    field: 'creator_name',\n                    cols: {\n                        lg: 4\n                    }\n                },\n                {\n                    label: 'Assignée à',\n                    field: 'executer_name',\n                    cols: {\n                        lg: 4\n                    }\n                },\n                {\n                    label: 'Validée par',\n                    field: 'validator_name',\n                    cols: {\n                        lg: 4\n                    }\n                },\n            ],\n            actions: {\n                edit: {\n                    show: (item) => {\n                        const userId = user().id\n                        return this.can('edit_task') && !item.is_resolved && (userId == item?.created_by_id || (item.assigned_to_id == null || item.assigned_to_id == userId))\n                    },\n                    apply: this.edit\n                },\n                delete: {\n                    show: (item) => {\n                        const userId = user().id\n                        return this.can('delete_task') && !item.is_resolved && (userId == item?.created_by_id || (item.assigned_to_id == null || item.assigned_to_id == userId))\n                    },\n                    apply: this.destroy\n                }\n            }\n        }\n    },\n    methods: {\n        /**\n         * Redirige vers la page d'edition\n         * @param {Object} item\n         */\n        edit(item) {\n            this.$router.push({ name: 'tasks-edit', params: { task: item.item.id } })\n        },\n\n        /**\n         * Valide la ressource\n         * @param {Object} item\n         */\n        validate(item) {\n            this.$swal.confirm_update('Voulez-vous marquer cette tâche comme résolue').then((action) => {\n                if (action.isConfirmed) {\n                    api.put('tasks/' + item.id + '/validate').then(response => {\n                        if (response.data.status) {\n                            this.refresh += 1\n                            this.$swal.toast_success(response.data.message)\n                        } else {\n                            this.$swal.toast_error(response.data.message)\n                        }\n                    })\n                }\n            }).catch(error => {\n                this.$swal.alert_error()\n            })\n        },\n\n        /**\n         * Supprime la ressource\n         * @param {Object} item\n         */\n        destroy(item) {\n            this.$swal.confirm_destroy().then((action) => {\n                if (action.isConfirmed) {\n                    api.delete('tasks/' + item.item.id).then(response => {\n                        if (response.data.status) {\n                            this.refresh += 1\n                            this.$swal.toast_success(response.data.message)\n                        } else {\n                            this.$swal.toast_error(response.data.message)\n                        }\n                    })\n                }\n            }).catch(error => {\n                this.$swal.alert_error()\n            })\n        },\n    }\n}\n</script>\n","import { render } from \"./index.vue?vue&type=template&id=5d38f3aa\"\nimport script from \"./index.vue?vue&type=script&lang=js\"\nexport * from \"./index.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"D:\\\\skaalab\\\\task-management\\\\node_modules\\\\vue-loader\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__"],"names":["_createElementVNode","class","layout","middleware","metaInfo","title","created","this","$store","dispatch","data","refresh","columns","label","field","sortable","details","cols","lg","isHtml","actions","edit","show","item","userId","user","id","can","is_resolved","created_by_id","assigned_to_id","apply","delete","destroy","methods","$router","push","name","params","task","validate","$swal","confirm_update","then","action","isConfirmed","api","put","response","status","toast_success","message","toast_error","error","alert_error","confirm_destroy","_ctx","_createElementBlock","_createVNode","_component_ContentHeader","_createBlock","_component_router_link","to","_component_ContentBody","_component_NLDatatable","$data","urlPrefix","onEdit","$options","onDelete","onDataLoaded","onClick"],"sourceRoot":""}